(window["webpackJsonptheremin-ui"]=window["webpackJsonptheremin-ui"]||[]).push([[0],{220:function(e,n,o){e.exports=o(383)},245:function(e,n){},247:function(e,n){},257:function(e,n){},259:function(e,n){},286:function(e,n){},287:function(e,n){},292:function(e,n){},294:function(e,n){},318:function(e,n){},368:function(e,n,o){},380:function(e,n,o){},381:function(e,n,o){},382:function(e,n,o){},383:function(e,n,o){"use strict";o.r(n);var t,a=o(5),r=o.n(a),c=o(25),i=o.n(c),u=o(67),s=o.n(u),l=o(7),m=(o(227),o(92)),d=o(19),f=o(164),g=o.n(f),h=o(0),v=o(2),w=o(1),E=o(36),R=o(386),p=o(22),C=o(165),M=o.n(C),P=R.g.create({position:p.a.BOTTOM,usePortal:!0,canEscapeKeyClear:!0}),T=(o(368),function(e){Object(v.a)(o,e);var n=Object(w.a)(o);function o(e){var t;return Object(h.a)(this,o),(t=n.call(this,e)).componentDidMount=function(){},t.generateRoomCode=function(){return M.a.generate({length:5,charset:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"})},t.joinRoom=function(e){var n=e.roomCode,o=e.host?"?host=true":"";t.props.history.push("/room/".concat(n).concat(o))},t.launchNewRoom=function(){P.show({timeout:2e3,message:"Launching new room ...",icon:"drawer-left",intent:E.a.PRIMARY});var e=t.generateRoomCode();t.joinRoom({roomCode:e,host:!0})},t.joinExistingRoom=function(){P.show({timeout:2e3,message:"Joining existing room ...",icon:"drawer-left",intent:E.a.PRIMARY});var e=t.state.roomCode;t.joinRoom({roomCode:e,host:!1})},t.setNewRoom=function(e){return t.setState({creatingNewRoom:e})},t.onCodeChange=function(e){var n=e.target.value.toUpperCase(),o=e.target,a=o.selectionStart,r=o.selectionEnd;return t.setState({roomCode:n},(function(){return o.setSelectionRange(a||0,r||0)}))},t.render=function(){var e=t.state,n=e.creatingNewRoom,o=e.roomCode,a=r.a.createElement(R.e,{content:r.a.createElement(R.c,null,r.a.createElement(R.d,{text:"Create New Room",onClick:function(){return t.setNewRoom(!0)}}),r.a.createElement(R.d,{text:"Join Existing Room",onClick:function(){return t.setNewRoom(!1)}})),position:p.a.BOTTOM_RIGHT},r.a.createElement(R.a,{rightIcon:"caret-down",text:n?"Create New Room":"Join Existing Room"}));return r.a.createElement("div",null,r.a.createElement("h1",null,"Theremin"),r.a.createElement(R.b,{disabled:n,large:!0,placeholder:"JM4W7",rightElement:a,onChange:t.onCodeChange,value:o}),r.a.createElement(R.a,{large:!0,intent:E.a.PRIMARY,text:"Launch!",onClick:n?t.launchNewRoom:t.joinExistingRoom}))},t.state={creatingNewRoom:!0,roomCode:""},t}return o}(r.a.Component)),y=Object(d.e)(T),O=o(11),_=o(170),b=(o(380),Object({NODE_ENV:"production",PUBLIC_URL:"/web-theremin",REACT_APP_QKT_HOST:"",REACT_APP_QKT_PORT:"",REACT_APP_THEREMIN_HOST:"localhost",REACT_APP_THEREMIN_PORT:"5000"}));b.REACT_APP_THEREMIN_HOST,b.REACT_APP_THEREMIN_PORT;!function(e){e[e.Loading=0]="Loading",e[e.Playing=1]="Playing",e[e.Muted=2]="Muted"}(t||(t={}));var N=function(e){var n=e.frequency,o=e.volume,t=Math.log2(n/440),a=o/20,r=[t,a].map((function(e){return Math.floor((n=256*e,o=0,t=255,Math.max(o,Math.min(t,n))));var n,o,t})),c=Object(O.a)(r,2),i=c[0];c[1];return"rgba(".concat(i,",0,0,").concat(a,")")},S=function(e){Object(v.a)(o,e);var n=Object(w.a)(o);function o(e){var a;return Object(h.a)(this,o),(a=n.call(this,e)).channel=null,a.osc=void 0,a.screenRef=void 0,a.onOpen=function(){console.log("opened connection."),console.log("sending greeting."),a.channel.sendData({message:"hi"})},a.onError=function(e){console.log("Got an error",e)},a.onClose=function(){console.log("closed connection lol.")},a.onData=function(e){console.log("data received: ".concat(e))},a.onMouseDown=function(){a.osc.start(),a.setState({stage:t.Playing})},a.onMouseUp=function(){a.osc.stop(),a.setState({stage:t.Muted})},a.locsToSound=function(e){var n=a.screenRef.current;if(null===n)return null;var o=n.getBoundingClientRect(),t=o.height,r=o.width;console.log(t,r);var c=function(e){return e.reduce((function(e,n){return e+n}))/e.length},i=e.map((function(e){return e.x/r})),u=e.map((function(e){return e.y/t})),s=c(i),l=c(u);return 0<=s&&s<=1&&0<=l&&l<=1?{frequency:440*Math.pow(2,s),volume:20*l}:null},a.onMouseMove=function(e){var n=e.x,o=e.y,r=a.locsToSound([{x:n,y:o}]);if(null!==r){var c=r.frequency,i=r.volume;console.log("(".concat(n,", ").concat(o,") => ").concat(c," Hz, ").concat(i," db")),a.osc.frequency.value=c,a.osc.volume.value=i;var u=a.state.stage;if(u===t.Playing){var s=N(r);a.setState({stage:u,color:s})}}},a.componentDidMount=function(){P.show({timeout:2e3,message:"Successfully joined room",icon:"tick",intent:E.a.SUCCESS}),window.addEventListener("mousedown",a.onMouseDown),window.addEventListener("mouseup",a.onMouseUp),window.addEventListener("mousemove",a.onMouseMove),a.setState({stage:t.Playing})},a.componentWillUnmount=function(){window.removeEventListener("mousedown",a.onMouseDown),window.removeEventListener("mouseup",a.onMouseUp),window.removeEventListener("mousemove",a.onMouseMove)},a.render=function(){var e=a.state,n=e.stage,o=e.color;return console.log(o),r.a.createElement("div",{className:"full",ref:a.screenRef,style:{borderColor:n===t.Playing?o:"#000000",borderWidth:"7px",borderStyle:"solid"}},n===t.Loading&&r.a.createElement(R.f,null))},a.osc=new _.a({type:"sine",frequency:440,volume:-10}).toDestination(),a.screenRef=r.a.createRef(),a.state={color:"#000000",stage:t.Loading},a}return o}(r.a.Component),A=function(){return r.a.createElement(m.a,null,r.a.createElement(d.a,{path:"/room/:roomCode",render:function(e){var n=e.match.params.roomCode,o="true"===g.a.parse(e.location.search).host;return r.a.createElement(S,Object.assign({},e,{roomCode:n,host:o}))}}),r.a.createElement(d.a,{path:"/",render:function(e){return r.a.createElement(y,e)}}))};o(381);s.a.config();var j=function(){return r.a.createElement("div",{className:"App ".concat(l.a.DARK),style:{width:"100vw",height:"100vh"}},r.a.createElement(A,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o(382);s.a.config(),i.a.render(r.a.createElement(j,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[220,1,2]]]);
//# sourceMappingURL=main.c2049530.chunk.js.map